# java-filmorate

Template repository for Filmorate project.

![Схема БД](schema.png)

Данные о фильмах хранятся в таблице "films". Таблица состоит из полей:

- первичный ключ film_id — идентификатор фильма;
- name - название фильма;
- description - описание фильма;
- releaseDate - дата выхода фильма;
- duration - продолжительность фильма;
- genre - жанр фильма;
- mpa - рейтинг Ассоциации кинокомпаний (возрастной рейтинг).

Данные о пользователях хранятся в таблице "users". Таблица состоит из полей:

- первичный ключ user_id — идентификатор пользователя;
- email - электронная почта пользователя;
- login - логин пользователя;
- name - имя пользователя;
- birthday - дата рождения пользователя.

Для того чтобы отследить поставленные лайки пользователем создана таблица "user_likes". Таблица состоит из полей:

- первичный ключ generated_id - создается при добавлении пары пользователь-фильм, когда пользователем ставится лайк;
- внешний ключ user_id (отсылает к таблице "users", тип связи - один ко многим) - идентификатор пользователя;
- внешний ключ film_id (отсылает к таблице "films", тип связи - один ко многим) - идентификатор фильма.

Чтобы отследить добавление друзей создана таблица "friends". Таблица состоит из полей:

- первичный ключ generated_id - создается при добавлении пары пользователь-пользователь, когда отправляется заявка в
  друзья;
- внешний ключ user_id (отсылает к таблице "users", тип связи - один ко многим) - идентификатор пользователя;
- внешний ключ friend_id (отсылает к таблице "users", тип связи - один ко многим) - идентификатор пользователя;
- friendshipStatusIsConfirmed - отражает статус дружбы (если true, то дружба подтверждена).

Примеры запросов:

1. Вывести пользователей 2000 года рождения и вывести следующую информацию о пользователе: имя, логин, email. SELECT
   u.name, u.login, u.email FROM users AS u WHERE EXTRACT(YEAR FROM birthday) = 2000;

2. Вывести название и описание фильмов, вышедших в 2023 году. SELECT f.name, f.description FROM films AS f WHERE
   EXTRACT(YEAR FROM releaseDate) = 2023;

3.Вывести названия и описания комедий, продолжительностью от 60 до 100 минут без возрастных ограничений. SELECT f.name,
f.description FROM films AS f WHERE genre = 'COMEDY' AND duration BETWEEN 60 AND 100 AND mpa = 'G';

4. Вывести названия фильмов и количество лайков, поставленных этому фильму. Расположить фильмы по убыванию лайков.
   SELECT f.name COUNT(ul.user_id) AS amount_likes FROM user_likes AS ul INNER JOIN films AS f GROUP BY f.name ORDER BY
   amount_likes;

5. Вывести данные пользователя: имя, логин и почту и количество подтвержденных друзей. Расположить пользователей по
   количеству друзей по убыванию. Вывести первых 10 человек. SELECT u.name, COUNT(fr.friend_id) AS amount_friends FROM
   friends AS fr INNER JOIN user AS u WHERE friendshipStatusIsConfirmed = true GROUP BY u.name ORDER BY amount_friends
   DESC LIMIT 10;   
   